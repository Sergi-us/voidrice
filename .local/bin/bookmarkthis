#!/bin/sh
# SARBS Snippets Tool 2024-10-27
# Skript um ausgewählten Text zu snippets hinzuzufügen

# Hole den markierten Text (PRIMARY selection)
primary_selection="$(xclip -o)"

# Kopiere den markierten Text auch in die Zwischenablage (CLIPBOARD)
# Dies überschreibt alte Clipboard-Inhalte
echo "$primary_selection" | xclip -sel clip

# Definiere die Zieldatei
file="$HOME/.local/share/sarbs/snippets"

# Prüfe ob der Text bereits existiert
if grep -q "^$primary_selection$" "$file"; then
    notify-send "Hoppla.." "Bereits vorhanden!"
else
    notify-send "Bookmark hinzugefügt" "$primary_selection ist nun gespeichert in snippets"
    # Erstellt eine temporäre Datei
    temp_file=$(mktemp)
    # Schreibt den neuen Bookmark und den Inhalt der alten Datei in die temporäre Datei
    echo "$primary_selection" > "$temp_file"
    cat "$file" >> "$temp_file"
    # Bewegt die temporäre Datei zurück an die Stelle der ursprünglichen Datei
    mv "$temp_file" "$file"
fi
