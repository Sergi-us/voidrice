#!/bin/sh
# SARBS 09.07.2024
# Zeigt die Anzahl der aktualisierbaren Pakete fÃ¼r Pacman und YAY an.
#!/bin/sh

# Zeigt die Anzahl der aktualisierbaren Pakete an.
# Damit dies funktioniert, muss ein `pacman -Sy`-Befehl regelmÃ¤ÃŸig als
# Cronjob im Hintergrund als root ausgefÃ¼hrt werden. Dieses Script liest dann diese Pakete.
# Bei einem Klick wird ein Upgrade via pacman durchgefÃ¼hrt.
#
# FÃ¼ge den folgenden Text als Datei in /usr/share/libalpm/hooks/statusbar.hook hinzu:
#
# [Trigger]
# Operation = Upgrade
# Type = Package
# Target = *
#
# [Action]
# Description = Statusleiste aktualisieren...
# When = PostTransaction
# Exec = /usr/bin/pkill -RTMIN+8 dwmblocks # Oder i3blocks, falls i3 verwendet wird.

case $BLOCK_BUTTON in
	1) setsid -f "$TERMINAL" -e sb-popupgrade ;; # Linksklick zum Upgraden
	2) notify-send "$(/usr/bin/pacman -Qu)" ;; # Mittelklick zeigt aktualisierbare Pakete
	3) notify-send "ğŸ Upgrade-Modul" "ğŸ“¦: Anzahl der aktualisierbaren Pakete
- Linksklick, um Pakete zu aktualisieren
- Mittelklick, um aktualisierbare Pakete anzuzeigen" ;; # Rechtsklick fÃ¼r Hilfe
	6) setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;; # Strg + Rechtsklick zum Bearbeiten
esac

pacman -Qu | grep -Fcv "[ignored]" | sed "s/^/ğŸ“¦/;s/^ğŸ“¦0$//g"
